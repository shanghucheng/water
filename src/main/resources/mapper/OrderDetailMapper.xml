<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.water.mapper.OrderDetailMapper" >
  <resultMap id="BaseResultMap" type="com.water.entity.OrderDetail" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Nov 19 10:56:37 GMT+08:00 2019.
    -->
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="order_id" property="orderId" jdbcType="INTEGER" />
    <result column="address_id" property="addressId" jdbcType="INTEGER" />
    <result column="water_name" property="waterName" jdbcType="VARCHAR" />
    <result column="water_specs" property="waterSpecs" jdbcType="VARCHAR" />
    <result column="water_num" property="waterNum" jdbcType="VARCHAR" />
    <result column="water_price" property="waterPrice" jdbcType="VARCHAR" />
  </resultMap>

<select id="getUserOrder" resultType="map">
  SELECT
    CONCAT(orders.id,'') id,
    orders.order_date orderDate,
    water_info.name,
    water_info.image_url imageUrl,
    order_detail.water_specs waterSpecs,
    order_detail.water_num waterNum,
    order_detail.water_price waterPrice,
    CONCAT(( order_detail.water_num * order_detail.water_price ),'') price
  FROM
    order_detail
      INNER JOIN orders ON orders.id = order_detail.order_id
      INNER JOIN user ON user.id = orders.user_id
      INNER JOIN water_info ON water_info.id=order_detail.water_id
  WHERE 1=1
  <if test="id!=null and id!=''">
    AND USER.id = ${id}
  </if>

</select>

</mapper>